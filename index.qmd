---
title: "Visualization of Crop and Livestock products"
subtitle: "INFO 526 - Fall 2024 - Project 01"
author: 
  - name: "VizCats"
    affiliations:
      - name: "School of Information, University of Arizona"
description: "Project description"
format:
   html:
    code-tools: true
    code-overflow: wrap
    embed-resources: true
editor: visual
execute:
  warning: false
  echo: false
---

## Abstract

This project focuses on compiling and analyzing statistical data for a diverse range of 278 crop and livestock products. The dataset will be expressed in key indicators like production quantities, yields, and processed product outputs, making it a valuable resource for understanding global agricultural production patterns across crops and livestock industries.

## Introduction

This report analyzes the FAOSTAT Crop and Livestock Production dataset, which provides global agricultural production statistics across more than 200 countries. The dataset covers crop production volumes, harvested areas, and yields, alongside livestock statistics. The objective of this project is to explore trends in agricultural productivity, compare regional outputs, and assess the sustainability of agricultural practices.

## Source of the Data

The data used in this report is curated by the Food and Agriculture Organization (FAO) of the United Nations, through their FAOSTAT database. It includes data collected annually since 1961 from government sources, surveys, and FAO estimates. website link : https://www.fao.org/faostat/en/#data/QCL

## Data Collection

The dataset is compiled from official reports from national statistical offices, and in cases of missing data, FAO uses estimation methods. This ensures consistency in the data for over 200 countries and regions.

## Column Observations

The dataset consists of 79,381 rows and 195 columns. Each row represents the production data for a specific commodity in a given country and year. The key variables include:

-   **Area**: Country or region.
-   **Item**: Commodity (e.g., wheat, rice, livestock).
-   **Element**: Type of data (e.g., production, area harvested).
-   **Year**: Year of the observation.
-   **Yxxxx**: Yearly production data. (e.g., Y1961, Y1962), where xxxx is the year.
-   **Value**: Recorded production value.

## Exploratory Data Analysis (EDA)

We took a number of measures to carry out inspection, cleaning, and visualization of the data effectively, which in turn enables us to conduct analysis regarding livestock production trends and its regional distribution.

1.  **Data Inspection**

Understanding the structure and content of a dataset is essential, so this method consisted of loading and examining the dataset. The dataset consists of several columns, including:

Area: Refers to the country or region.

Item: Denotes the specific livestock commodity (e.g., Beef, Poultry, Milk).

Element: Represents the type of data, such as “Production,” “Area harvested,” or “Yield.”

Year: The year of the data.

Value: The production value (in tons, hectares, etc.) for the specified year and item.

Examination of the dataset produced values that were relatively substantial as the data collected covered a period of several decades.

2.  **Data Cleaning**

For such cleaning operations, we focused removal of rows containing missing values on key columns such as Area, Item and Element. This step ensured that the analysis concentrated on completed records only without any other missing or non-relevant information.

Post- cleaning, the data was arranged in such a manner that Year and Item columns served as the grouping variables while Value was used to denote the total production or harvested area for that year and item.

3.  **Distribution of Livestock Holding Items**

The first insight was in livestock items distribution across the locations in the database. The commonest items cut across include beef, poultry, milk and pork, which form the leading lines in the livestock production for the world. This distribution gives an idea of the intensity of different types of livestock kept and can be useful in the later analysis by helping to establish in which region which commodities are most produced.

4.  **product Data Description**

We created an item-centric cross -section in the dataset for ”Production” data by such years. This brought out the perspective of total production for each livestock commodity in the course of time. The total amounts of production of every commodity were in estimates, which enabled the study to observe which livestock product had the biggest global turnovers in livestock production.

5.  **Annual Variation in Growth of Animal Resources**

An important aspect of the analysis was to assess the scope of change in livestock production in the course of time. We displayed the shifts in production of poultry, beef and milk over the period under analysis. For instance, while poultry and beef sectors witnessed dramatic increases during the period in the production, others grew only moderate or flat.

6.  **Livestock Production Across The World**

Thereafter, we proceeded to analyze livestock production from geographic perspective. We made a case to combine production statistics by Region (country) and inquired which countries are the most significant net live stock producers on a global basis. The findings suggest that livestock production is indeed concentrated in only a few countries and on top of that list are China, United States and Brazil.

In order to illustrate what these figures mean, we have created charts for the concentration of livestock production across the regions. This type of assessment enables the determination of regions which in the case of meat and milk production play more than just a peripheral role in world production.

7.  **Missing Data Analysis**

Among the other activities in EDA, one critical aspect is the identification and treatment of missing data. In the dataset, respondents from certain regions or years were missing which could impair the wholeness of our analysis. We checked for any non-response or partial non-response and presented the depiction of the distribution of missing data to ensure that it did not heavily impact our results.

## Methodology

This analysis examines the trends in global livestock production based on information from the FAOSTAT database focusing on several commodities, namely beef, poultry, and milk. Generally, a technique is conceived in terms of

1.  **Data Collection** Sourcing data basically from the FAOSTAT Crop and Livestock Production dataset, including volumes produced, harvested areas, and yields from various livestock commodities across the world of more than 200 countries.

Key datasets carried out for the analysis included:

Production_Crops_Livestock_E_All_Data.csv: It comprises production data for multiple livestock commodities. Production_Crops_Livestock_E_AreaCodes.csv: It provides the area (country) codes and names. Production_Crops_Livestock_E_Elements.csv: It provides the respective observations of various elements (production, area harvested, yield). Production_Crops_Livestock_E_ItemCodes.csv: It gives codes and descriptions of each component of livestock (i.e., Beef, Poultry, Milk).

2.  **Data Processing** The dataset was reshaped from a wide format (with columns for each year) to a long format (with year and value columns), enabling the analysis of time series data for each commodity. This was achieved by pivoting the dataset on the year column. Rows with missing values for essential columns, such as Year or Value, were removed. This ensured that only complete observations were used for analysis.

3.  **Data Aggregation** For subsequent analysis, the data was aggregated on various levels.An Annual Aggregation, total cattle production, area harvested, and yield were aggregated per commodity for each year. That is, the data for the respective years were grouped by Year and Element Value was then summed for each group. A commodity-level trend analysis was made to track and analyse the trends in production of individual livestock commodities over time. Any production data for each livestock item were aggregated and visualizations for individual livestock products over a certain period were constructed.

4.  **Visualization** There are a range of techniques used to create visualizations, including such that demonstrate time series data for global livestock trends; stacked area plots for individual commodity trends; choropleth maps indicating country-wise production. Interactive maps were used for per capita production exploration by country.

## Results

```{r, fig.height=9,fig.width=12}
library(dplyr)
library(ggplot2)

# Define the top crops you're interested in
top_crops <- c("Wheat", "Rice", "Maize (corn)", "Potatoes", "Barley", 
               "Cassava", "Sweet potatoes", "Sorghum", "Oats", "Beans")

# Summarize global production trends over time
global_production <- prod_data_long %>%
  group_by(Year, Item) %>%
  summarize(Global_Production = sum(Production, na.rm = TRUE), .groups = "drop")

# Create a line plot to visualize the global production trends over time
ggplot(global_production, aes(x = Year, y = Global_Production)) +
  geom_line(aes(color = Item), linewidth = 1.2) +  # Line plot with thicker lines
  theme_minimal() +
  labs(
    x = "Year", 
    y = "Global Production (Metric Tons)",  
    color = "Crop",
    title = "Global Production Trends of Top 10 Staple Crops (1961 - 2022)",
    caption = "Source: FAO"
  ) +
  scale_color_manual(
    values = c("Wheat" = "#FF5733", "Rice" = "#33C4FF", "Maize (corn)" = "#FFB533", 
               "Potatoes" = "#33FF57", "Barley" = "#5A33FF", "Cassava" = "#FF33A1", 
               "Sweet potatoes" = "#FF8533", "Sorghum" = "#33FFAA", "Oats" = "#FF33CC", 
               "Beans" = "#7A33FF"),
    labels = c("Wheat", "Rice", "Maize (corn)", "Potatoes", "Barley", 
               "Cassava", "Sweet potatoes", "Sorghum", "Oats", "Beans")
  ) +
  coord_cartesian(clip = "off") +
  theme(
    legend.position = c(0.36, 0.80),  
    legend.direction = "horizontal",  
    legend.box = "horizontal",      
    axis.title.x = element_text(hjust = 0.5, size = 18),  
    axis.title.y = element_text(hjust = 0.5, size = 18),  
    plot.title = element_text(size = 20, face = "bold", hjust = 0.5),
    plot.caption = element_text(size = 14, hjust = 1, color = "grey30"),
    legend.title = element_text(size = 18),
    legend.text = element_text(size = 16),
    axis.text.x = element_text(size = 14, face = "bold"),
    axis.text.y = element_text(size = 14, face = "bold")
  ) +
  scale_y_continuous(
    labels = scales::comma_format(scale = 1e-6, prefix = "", suffix = "M"),  
    breaks = seq(0, max(global_production$Global_Production, na.rm = TRUE), by = 200000000)
  ) +
  scale_x_continuous(
    breaks = seq(min(global_production$Year, na.rm = TRUE), max(global_production$Year, na.rm = TRUE), by = 5)
  ) +
  theme(
    plot.margin = margin(2, 2, 2, 2) 
  )


```

```{r}
# Load required libraries
library(dplyr)
library(ggplot2)
library(sf)
library(rnaturalearth)

# Load world map data
world <- ne_countries(scale = "medium", returnclass = "sf")

# Aggregate total production of top 10 crops by country
top_crops <- c("Wheat", "Rice", "Maize (corn)", "Potatoes", "Barley", 
               "Cassava", "Sweet potatoes", "Sorghum", "Oats", "Beans")

agg_prod_data <- prod_data_long %>%
  filter(Item %in% top_crops) %>%
  group_by(Area) %>%
  summarize(Total_Production = sum(Production, na.rm = TRUE), .groups = "drop")

# Join aggregated data with world map
regional_map_data <- world %>%
  left_join(agg_prod_data, by = c("name" = "Area"))

# Create the choropleth map
ggplot(data = regional_map_data) +
  geom_sf(aes(fill = Total_Production), color = "black", size = 0.1) +
  scale_fill_gradient(
    low = "#3182bd", 
    high = "#225577", 
    name = "Total Production\n(Metric Tons)",
    labels = scales::comma_format(scale = 1e-6, suffix = "M"), 
    na.value = "#e0efff", 
    guide = guide_colorbar(barwidth = 15, barheight = 1)
  ) +
  labs(
    title = "Production of Top 10 Staple Crops",
    caption = "Source: FAO"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 20, face = "bold", hjust = 0.5),
    plot.caption = element_text(size = 14, hjust = 1, color = "#e0efff"),
    legend.position = "bottom",
    legend.title = element_text(size = 16),
    legend.text = element_text(size = 14),
    axis.text = element_blank(),
    axis.title = element_blank()
  )


```

```{r, fig.height=9,fig.width=12}
# Define developed and developing countries
developed_countries <- c("United States", "Canada", "Germany", "United Kingdom", "France", "Australia", "Japan")
developing_countries <- c("India", "China", "Brazil", "Nigeria", "Indonesia", "Mexico", "South Africa")

prod_data_long <- prod_data_long %>%
  mutate(
    Country_Category = case_when(
      Area %in% developed_countries ~ "Developed",
      Area %in% developing_countries ~ "Developing",
      TRUE ~ "Other"
    )
  )

# Filter and aggregate production by year and category
prod_data_classified <- prod_data_long %>%
  filter(Country_Category %in% c("Developed", "Developing"))

agg_trends <- prod_data_classified %>%
  group_by(Year, Country_Category) %>%
  summarize(Total_Production = sum(Production, na.rm = TRUE), .groups = "drop")

# Create the line plot
ggplot(agg_trends, aes(x = Year, y = Total_Production, color = Country_Category, group = Country_Category)) +
  geom_line(linewidth = 1.2) +
  theme_minimal() +
  labs(
    title = "Production Trends of Staple Crops in Developed vs. Developing Countries (1961 - 2022)",
    x = "Year",
    y = "Total Production (Metric Tons)",
    color = "Country Category",
    caption = "Source: FAO"
  ) +
  scale_y_continuous(
    labels = scales::comma_format(scale = 1e-6, suffix = "M"),
    breaks = scales::pretty_breaks(n = 10)
  ) +
  scale_x_continuous(
    breaks = seq(min(prod_data_classified$Year, na.rm = TRUE), max(prod_data_classified$Year, na.rm = TRUE), by = 5)
  ) +
  scale_color_manual(
    values = c("Developed" = "blue", "Developing" = "orange")
  ) +
  theme(
    plot.title = element_text(size = 22, face = "bold", hjust = 0.5),
    axis.title.x = element_text(size = 19),
    axis.title.y = element_text(size = 19),
    axis.text = element_text(size = 12),
    legend.position = c(0.3, 0.75),
    legend.title = element_text(size = 19),
    legend.text = element_text(size = 18)
  )

```

```{r}
# Load required libraries
library(ggplot2)
library(dplyr)

# Filter the data to only include "Production" for the Element
aggregated_data_production <- aggregated_data %>%
  filter(Element == "Production")

# Create the line plot for production only
ggplot(data = aggregated_data_production, aes(x = Year, y = Total_Value / 1e6, color = Element)) +
  geom_line(linewidth = 1.2) +
  labs(
    title = "Global Trends in Livestock Production",
    x = "Year",
    y = "Volume (Millions of Tons)",
    color = "Element"
  ) +
  theme(
    plot.title = element_text(size = 22, face = "bold", hjust = 0.5),
    axis.title.x = element_text(size = 19),
    axis.title.y = element_text(size = 19),
    axis.text = element_text(size = 12),
    plot.caption = element_text(size = 14, hjust = 1, color = "grey30"),
    legend.position = "right",  # Legend on the right
    legend.direction = "vertical",  # Stack legend vertically
    legend.title = element_text(size = 19),
    legend.text = element_text(size = 18),
    panel.background = element_rect(fill = "white", color = NA),  # Set white background
    plot.background = element_rect(fill = "white", color = NA),  # Ensure white plot background
    panel.grid.major = element_line(color = "grey90"),  # Subtle grid lines
    panel.grid.minor = element_blank()  # Remove minor grid lines
  ) +
  scale_y_continuous(labels = scales::comma)


```

```{r, fig.height=9,fig.width=12}
# Plot 2: Trends in individual livestock commodities (Production Only)
ggplot(data = commodity_trends, aes(x = Year, y = Total_Production / 1e6, fill = Item)) +
  geom_area(position = "stack", alpha = 0.7) +
  labs(
    title = "Trends in Production of Livestock Commodities",
    x = "Year",
    y = "Production Volume ( Millions - Tons )",
    fill = "Commodity"
  ) +
   theme(
    plot.title = element_text(size = 22, face = "bold", hjust = 0.5),
    axis.title.x = element_text(size = 19),
    axis.title.y = element_text(size = 19),
    axis.text = element_text(size = 12),
    plot.caption = element_text(size = 14, hjust = 1, color = "grey30"),
    legend.position = "right",  # Legend on the right
    legend.direction = "vertical",  # Stack legend vertically
    legend.title = element_text(size = 19),
    legend.text = element_text(size = 18),
    panel.background = element_rect(fill = "white", color = NA),  # Set white background
    plot.background = element_rect(fill = "white", color = NA),  # Ensure white plot background
    panel.grid.major = element_line(color = "grey90"),  # Subtle grid lines
    panel.grid.minor = element_blank()  # Remove minor grid lines
  )
```

```{r}
# Plot 3: Livestock Production on a World Map
ggplot() +
  geom_sf(data = world) +
  geom_sf(data = map_production, aes(geometry = geometry, fill = Total_Value), color = "black") +
  scale_fill_viridis_c(name = "Production (tons)", option = "C") +
  scale_fill_gradient(
    low = "khaki1", 
    high = "green4"
  )+
  labs(
    title = "Global Livestock Production",
    subtitle = "Production volumes (tons) by country",
    caption = "Source: FAO Livestock Data"
  ) +
  theme_minimal()


# Enhanced Leaflet Map
leaflet() %>%
  # Add a base map
  addProviderTiles(providers$CartoDB.Positron) %>%
  
  # Add Total Production Layer
  addPolygons(
    data = map_production_sf,
    fillColor = ~production_pal(Total_Value),
    color = "black",
    weight = 1,
    fillOpacity = ~pmax(Total_Value / max(map_production_sf$Total_Value, na.rm = TRUE), 0.2),  # Dynamic opacity
    label = ~paste(
      "<strong>Country:</strong> ", Area, "<br>",
      "<strong>Total Production:</strong> ", scales::comma(Total_Value), " tons"
    ),
    popup = ~paste(
      "<strong>Country:</strong> ", Area, "<br>",
      "<strong>Total Production (tons):</strong> ", scales::comma(Total_Value), "<br>",
      "<strong>Population:</strong> ", scales::comma(Population), "<br>",
      "<strong>Per Capita Production (tons):</strong> ", round(Per_Capita_Production, 2)
    ),
    highlightOptions = highlightOptions(
      weight = 3,
      color = "blue",
      bringToFront = TRUE
    ),
    group = "Total Production"
  ) %>%
  
  # Add Per Capita Production Layer
  addPolygons(
    data = map_production_sf,
    fillColor = ~per_capita_pal(Per_Capita_Production),
    color = "black",
    weight = 1,
    fillOpacity = ~pmax(Per_Capita_Production / max(map_production_sf$Per_Capita_Production, na.rm = TRUE), 0.2),  # Dynamic opacity
    label = ~paste(
      "<strong>Country:</strong> ", Area, "<br>",
      "<strong>Per Capita Production:</strong> ", round(Per_Capita_Production, 2), " tons"
    ),
    popup = ~paste(
      "<strong>Country:</strong> ", Area, "<br>",
      "<strong>Per Capita Production (tons):</strong> ", round(Per_Capita_Production, 2), "<br>",
      "<strong>Total Production (tons):</strong> ", scales::comma(Total_Value), "<br>",
      "<strong>Population:</strong> ", scales::comma(Population)
    ),
    highlightOptions = highlightOptions(
      weight = 3,
      color = "green",
      bringToFront = TRUE
    ),
    group = "Per Capita Production"
  ) %>%
  
  # Add Layer Control
  addLayersControl(
    baseGroups = c("Base Map"),
    overlayGroups = c("Total Production", "Per Capita Production"),
    options = layersControlOptions(collapsed = FALSE)
  ) %>%
  
  # Add Legend for Total Production
  addLegend(
    pal = production_pal,
    values = map_production_sf$Total_Value,
    title = "Total Production<br>(in tons)",
    position = "bottomleft",
    group = "Total Production"
  ) %>%
  
  # Add Legend for Per Capita Production
  addLegend(
    pal = per_capita_pal,
    values = map_production_sf$Per_Capita_Production,
    title = "Per Capita<br>Production (tons)",
    position = "bottomright",
    group = "Per Capita Production"
  )
```

## Discussion

Analysis of livestock production trends worldwide has confirmed substantial increments in production involving poultry, beef, and milk due to the rising demand for population growth and dietary changes. However, contrary trends do exist: the countries in Asia and Africa might grow faster, while slow growth has occurred in Europe and America due to market maturity.

The study identifies some inefficiencies and environmental challenges of large-scale livestock production among the largest producers in the world, but it highlights the need for more sustainable practices. Additionally, livestock trade plays a very important role, with countries like Brazil and Australia putting their stamp on the production dynamics of the world.

The findings highlight that policymakers have to encourage sustainability and efficiency in livestock farming, alongside optimizing the consequences on the environment. Further research may deal with the effects of climate change and alternatives to conventional livestock products.

## Future work

Future research sectors should focus on studies that would assess the impact of climate change on livestock production in especially vulnerable regions. Also, it is imperative to explore alternative and sustainable livestock practices and alternative sources of protein to reduce the environmental impacts. More investigations will fill in the gap on policy interventions and international trades that shape global livestock production trends and how one balances production efficiencies with sustainability. Lastly, further social inquiry would consider the potential effects of technological innovations in animal farming on global production dynamics.

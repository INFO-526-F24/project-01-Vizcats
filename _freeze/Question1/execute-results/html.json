{
  "hash": "109b070fcb221b6014dca4d6b3dd4a50",
  "result": {
    "engine": "knitr",
    "markdown": "::: {.cell}\n\n```{.r .cell-code}\n# Load required libraries\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'dplyr'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(tidyr)\nlibrary(readr)\nlibrary(sf)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLinking to GEOS 3.12.2, GDAL 3.9.3, PROJ 9.4.1; sf_use_s2() is TRUE\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(rnaturalearth)\nlibrary(viridis)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: viridisLite\n```\n\n\n:::\n\n```{.r .cell-code}\n# Step 1: Load datasets\nprod_data <- read.csv(\"data/Production_Crops_Livestock_E_All_Data/Production_Crops_Livestock_E_All_Data.csv\")\narea_codes <- read.csv(\"data/Production_Crops_Livestock_E_All_Data/Production_Crops_Livestock_E_AreaCodes.csv\")\nitem_codes <- read.csv(\"data/Production_Crops_Livestock_E_All_Data/Production_Crops_Livestock_E_ItemCodes.csv\")\nelements <- read.csv(\"data/Production_Crops_Livestock_E_All_Data/Production_Crops_Livestock_E_Elements.csv\")\nprod_data_long <- read.csv(\"data/Processed_Staple_Crops_Production.csv\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Define the top crops you are interested in (adjust based on your needs)\ntop_crops <- c(\"Wheat\", \"Rice\", \"Maize (corn)\", \"Potatoes\", \"Barley\", \n               \"Cassava\", \"Sweet potatoes\", \"Sorghum\", \"Oats\", \"Beans\")\n\n# Summarize global production trends over time\nglobal_production <- prod_data_long %>%\n  group_by(Year, Item) %>%\n  summarize(Global_Production = sum(Production, na.rm = TRUE), .groups = \"drop\")\n\n# Create a line plot to visualize the global production trends over time\nggplot(global_production, aes(x = Year, y = Global_Production)) +\n  geom_line(aes(color = Item), linewidth = 1.2) +  # Line plot with thicker lines\n  theme_minimal() +\n  labs(\n    x = \"Year\", \n    y = \"Global Production (Metric Tons)\",  \n    color = \"Crop\",\n    title = \"Global Production Trends of Top 10 Staple Crops (1961 - 2022)\",\n    caption = \"Source: FAO\"\n  ) +\n  scale_color_manual(\n    values = c(\"Wheat\" = \"#FF5733\", \"Rice\" = \"#33C4FF\", \"Maize (corn)\" = \"#FFB533\", \n               \"Potatoes\" = \"#33FF57\", \"Barley\" = \"#5A33FF\", \"Cassava\" = \"#FF33A1\", \n               \"Sweet potatoes\" = \"#FF8533\", \"Sorghum\" = \"#33FFAA\", \"Oats\" = \"#FF33CC\", \n               \"Beans\" = \"#7A33FF\"),\n    labels = c(\"Wheat\", \"Rice\", \"Maize (corn)\", \"Potatoes\", \"Barley\", \n               \"Cassava\", \"Sweet potatoes\", \"Sorghum\", \"Oats\", \"Beans\")\n  ) +\n  coord_cartesian(clip = \"off\") +\n  theme(\n    legend.position = c(0.36, 0.80),  \n    legend.direction = \"horizontal\",  \n    legend.box = \"horizontal\",      axis.title.x = element_text(hjust = 0.5, size = 18),  \n    axis.title.y = element_text(hjust = 0.5, size = 18),  \n    plot.title = element_text(size = 20, face = \"bold\", hjust = 0.5),  # Increase title font size\n    plot.caption = element_text(size = 14, hjust = 1, color = \"grey30\"),  # Caption with slightly larger font\n    legend.title = element_text(size = 18),  # Increase legend title font size\n    legend.text = element_text(size = 16),  # Increase legend text font size\n    axis.text.x = element_text(size = 14, face = \"bold\"),  # Increase and bold X axis tick labels\n    axis.text.y = element_text(size = 14, face = \"bold\")   # Increase and bold Y axis tick labels\n  ) +\n  scale_y_continuous(\n    labels = scales::comma_format(scale = 1e-6, prefix = \"\", suffix = \"M\"),  # Format y-axis in millions with commas\n    breaks = seq(0, max(global_production$Global_Production, na.rm = TRUE), by = 200000000)  # Reduced step size for y-axis ticks\n  ) +\n  scale_x_continuous(\n    breaks = seq(min(global_production$Year, na.rm = TRUE), max(global_production$Year, na.rm = TRUE), by = 5)  # Increase x-axis ticks\n  ) +\n  # Set figure size for output\n  theme(\n    plot.margin = margin(2, 2, 2, 2)  # Increase plot margin if needed\n  )\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: A numeric `legend.position` argument in `theme()` was deprecated in ggplot2\n3.5.0.\nâ„¹ Please use the `legend.position.inside` argument of `theme()` instead.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Question1_files/figure-html/unnamed-chunk-2-1.png){width=1152}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load required libraries\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(sf)\nlibrary(rnaturalearth)\nlibrary(viridis)\n\n# Load world map data\nworld <- ne_countries(scale = \"medium\", returnclass = \"sf\")\n\n# Aggregate total production of top 10 crops by country\ntop_crops <- c(\"Wheat\", \"Rice\", \"Maize (corn)\", \"Potatoes\", \"Barley\", \n               \"Cassava\", \"Sweet potatoes\", \"Sorghum\", \"Oats\", \"Beans\")\n\nagg_prod_data <- prod_data_long %>%\n  filter(Item %in% top_crops) %>%\n  group_by(Area) %>%\n  summarize(Total_Production = sum(Production, na.rm = TRUE), .groups = \"drop\")\n\n# Join aggregated data with world map\nregional_map_data <- world %>%\n  left_join(agg_prod_data, by = c(\"name\" = \"Area\"))\n\n# Create the choropleth map\nggplot(data = regional_map_data) +\n  geom_sf(aes(fill = Total_Production), color = \"black\", size = 0.1) +\n  scale_fill_gradient(\n    low = \"#3182bd\", \n    high = \"#225577\", \n    name = \"Total Production\\n(Metric Tons)\",\n    labels = scales::comma_format(scale = 1e-6, suffix = \"M\"), \n    na.value = \"#e0efff\", \n    guide = guide_colorbar(barwidth = 15, barheight = 1)\n  ) +\n  labs(\n    title = \"Production of Top 10 Staple Crops\",\n    caption = \"Source: FAO\"\n  ) +\n  theme_minimal() +\n  theme(\n    plot.title = element_text(size = 20, face = \"bold\", hjust = 0.5),\n    plot.caption = element_text(size = 14, hjust = 1, color = \"#e0efff\"),\n    legend.position = \"bottom\",\n    legend.title = element_text(size = 16),\n    legend.text = element_text(size = 14),\n    axis.text = element_blank(),\n    axis.title = element_blank()\n  )\n```\n\n::: {.cell-output-display}\n![](Question1_files/figure-html/unnamed-chunk-3-1.png){width=1152}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load required libraries\nlibrary(dplyr)\nlibrary(ggplot2)\n\n# Classify countries into Developed and Developing\ndeveloped_countries <- c(\"United States\", \"Canada\", \"Germany\", \"United Kingdom\", \"France\", \"Australia\", \"Japan\")\ndeveloping_countries <- c(\"India\", \"China\", \"Brazil\", \"Nigeria\", \"Indonesia\", \"Mexico\", \"South Africa\")\n\nprod_data_long <- prod_data_long %>%\n  mutate(\n    Country_Category = case_when(\n      Area %in% developed_countries ~ \"Developed\",\n      Area %in% developing_countries ~ \"Developing\",\n      TRUE ~ \"Other\"\n    )\n  )\n\n# Filter and aggregate production by year and category\nprod_data_classified <- prod_data_long %>%\n  filter(Country_Category %in% c(\"Developed\", \"Developing\"))\n\nagg_trends <- prod_data_classified %>%\n  group_by(Year, Country_Category) %>%\n  summarize(Total_Production = sum(Production, na.rm = TRUE), .groups = \"drop\")\n\n# Create the line plot\nggplot(agg_trends, aes(x = Year, y = Total_Production, color = Country_Category, group = Country_Category)) +\n  geom_line(linewidth = 1.2) +\n  theme_minimal() +\n  labs(\n    title = \"Production Trends of Staple Crops in Developed vs. Developing Countries (1961 - 2022)\",\n    x = \"Year\",\n    y = \"Total Production (Metric Tons)\",\n    color = \"Country Category\",\n    caption = \"Source: FAO\"\n  ) +\n  scale_y_continuous(\n    labels = scales::comma_format(scale = 1e-6, suffix = \"M\"),\n    breaks = scales::pretty_breaks(n = 10)\n  ) +\n  scale_x_continuous(\n    breaks = seq(min(prod_data_classified$Year, na.rm = TRUE), max(prod_data_classified$Year, na.rm = TRUE), by = 5)\n  ) +\n  scale_color_manual(\n    values = c(\"Developed\" = \"blue\", \"Developing\" = \"orange\")\n  ) +\n  theme(\n    plot.title = element_text(size = 22, face = \"bold\", hjust = 0.5),\n    axis.title.x = element_text(size = 19),\n    axis.title.y = element_text(size = 19),\n    axis.text = element_text(size = 12),\n    legend.position = c(0.3, 0.75),\n    legend.title = element_text(size = 19),\n    legend.text = element_text(size = 18)\n  )\n```\n\n::: {.cell-output-display}\n![](Question1_files/figure-html/unnamed-chunk-4-1.png){width=1344}\n:::\n:::",
    "supporting": [
      "Question1_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}